<!-- build time:Wed May 28 2025 20:09:24 GMT+0000 (Coordinated Universal Time) --><!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="google-site-verification" content="5zx5xIGOp0FNxcFEvh9Rls0F6vdo4JcDkQNT_PG4ZvQ"><meta name="msvalidate.01" content="330584D871B0D2751FD232BD023460DA"><link rel="alternate" type="application/rss+xml" title="The Workshop" href="https://the-m3chanic.github.io/rss.xml"><link rel="alternate" type="application/atom+xml" title="The Workshop" href="https://the-m3chanic.github.io/atom.xml"><link rel="alternate" type="application/json" title="The Workshop" href="https://the-m3chanic.github.io/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="Security,Reversing,CTF,eBPF,Writeup"><link rel="canonical" href="https://the-m3chanic.github.io/2024/02/26/Writeup-beehive-bi0sCTF-2024/"><title>Writeup - beehive - bi0sCTF 2024 - Writeup | the.m3chanic = The Workshop</title><meta name="generator" content="Hexo 7.0.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">Writeup - beehive - bi0sCTF 2024</h1><div class="meta"><span class="item" title="Created: 26-02-2024 03:23:31"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">Posted on</span> <time itemprop="dateCreated datePublished" datetime="2024-02-26T03:23:31Z">26-02-2024</time></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="Toggle navigation bar"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">the.m3chanic</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax static-grey-bg"><div class="grey-placeholder"></div></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">Home</a></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/Writeup/" itemprop="item" rel="index" title="In Writeup"><span itemprop="name">Writeup</span></a><meta itemprop="position" content="1"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="en"><link itemprop="mainEntityOfPage" href="https://the-m3chanic.github.io/2024/02/26/Writeup-beehive-bi0sCTF-2024/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="Suraj Kumar"><meta itemprop="description" content=", "></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="The Workshop"></span><div class="body md" itemprop="articleBody"><p><strong>tl;dr</strong></p><ul><li>Custom hook to syscall 0x31337 using eBPF</li><li>Check on the argument passed to syscall to verify correct/incorrect key</li></ul><h2 id="challenge-description"><a class="anchor" href="#challenge-description">#</a> Challenge description:</h2><p>according to all known laws of aviation, there is no way a bee should be able to fly</p><p>In this writeup I'll be covering the challenge I authored for bi0s CTF, 2024.<br>I intended for this to be an easy warmup challenge for the players, and hopefully some people learned some new stuff from it as well 😃</p><h2 id="initial-analysis"><a class="anchor" href="#initial-analysis">#</a> Initial Analysis</h2><p>In the handout, there is a single file, <code>beehive.o</code> , let's take a look at what kind of file it is</p><p><img data-src="/images/post_images/Writeup-beehive-bi0sCTF-2024/image.png" alt="file type"></p><p>So it's an ELF file, but of type eBPF. What is eBPF?</p><p>(I'm going to dive a little deep into eBPF and things surrounding it. If you're only here for the solution to the challenge, you can skip to the <a href="#the-solution">solution</a>)</p><h2 id="understanding-ebpf"><a class="anchor" href="#understanding-ebpf">#</a> Understanding eBPF</h2><p>eBPF is a technology that can be used in the Linux kernel that is like running a very tightly bound (ability-wise) program directly in the kernel space. It is an event-driven language that can be used to hook kernel actions and perform specific tasks.</p><p>It runs natively in the kernel space with the help of a JIT compiler.</p><p>It’s basically a kernel level virtual machine that allows for programming of certain kernel level tasks, such as packet filtering, tracing, etc. Essentially a small computer inside the kernel that can run custom programs with restricted access.</p><p>Basically, think of it as a Kernel level javascript running inside a restrictive VM.</p><p>The obvious question that might come in your mind is - <strong>How is eBPF different from normal kernel drivers or kernel modules</strong>?</p><p>Well, the answer to that is simple:<br>eBPF programs don’t have nearly the amount of permissions as a regular kernel module, so you could say that they run in a much more constrained environment. They can’t make any drastic changes to the behaviour of the kernel, so this adds to their security and can help in reducing crashes. It’s perfectly in between a user program and a kernel program, in the sense that it runs in the kernel space, but with restrictions that differentiate it from an actual kernel module.</p><p>Now that we've got the basics out of the way, let's get back to solving the challenge.</p><h2 id="our-approach"><a class="anchor" href="#our-approach">#</a> Our Approach</h2><p>Some google searches tell us that eBPF can be disassembled using <code>llvm</code> , so let's give that a try</p><p><img data-src="/images/post_images/Writeup-beehive-bi0sCTF-2024/image-1.png" alt="llvm output"></p><p>Sure enough, we get the output, and in that we see a function called <code>weird_function</code> , now let's take a look at what it does</p><p>One thing to keep in mind is: eBPF has its own instruction set architecture, so everything from registers to calling convention will be different</p><p>Quick overview of eBPF architecture:<br></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">eBPF is a RISC register machine with 11 registers in total. Each 64-bits in size. </span><br><span class="line"></span><br><span class="line">9 of these registers are general purpose, with arbitrary read-write over each of them. One register is a read-only stack pointer, and one implicit program counter (in the sense, we can only jump to a particular offset with it). </span><br><span class="line"></span><br><span class="line">The VM registers are always 64-bits wide, even if it’s running on a 32-bit processor, the rest of the bits are just zeroed out in that case. </span><br><span class="line"></span><br><span class="line">r0 register holds the return value of helper function calls</span><br><span class="line"></span><br><span class="line">r1-r5 hold the function arguments for kernel function calls, r6-r9 are callee saved registers </span><br><span class="line"></span><br><span class="line">r0 also stores the exit value when the eBPF program exits from the kernel.</span><br></pre></td></tr></table></figure><p></p><h2 id="understanding-the-challenge"><a class="anchor" href="#understanding-the-challenge">#</a> Understanding the challenge</h2><p>Now, the first few instructions from the dump kind of give us an idea of what's going on here.</p><p>A bunch of stuff is loaded on the stack first, following which the last value loaded on top is later compared to 0x31337.</p><p>In eBPF, whenever a syscall is made, arguments passed to the syscall are pushed on the stack in reverse order, and the syscall number is pushed last (i.e, at the top). We can see that our program is doing something similar here.</p><p>We know that eBPF harbours the capability to hook onto syscalls on the kernel, so could it be possible that it is trying to hook onto syscall 0x31337?<br>Let's confirm that hunch.</p><p>A failed comparison of the syscall number with 0x31337 leads us to label-18, which is</p><p><img data-src="/images/post_images/Writeup-beehive-bi0sCTF-2024/image-2.png" alt="exit label"></p><p>So I think we would need to make the syscall number 0x31337 to interact with this program. But what do we pass to it?</p><p><img data-src="/images/post_images/Writeup-beehive-bi0sCTF-2024/image-3.png" alt="strings output"></p><p>Seems like the program is asking for a key, and verifies that key for us.</p><p>Obviously the entire program can't be efficiently analysed using just the object dump, so I will switch to IDA PRO for the remainder of this writeup.<br>By default, IDA is not capable of recognising this machine type, but there is a handy <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2N5bGFuY2UvZUJQRl9wcm9jZXNzb3I=">processor</span> plugin that supports eBPF.</p><p>The output still doesn't look too clean on IDA, so we can run the scripts on the processor repo to relocate maps and clean up eBPF helper calls for us.</p><p>(To run script files on IDA: File -&gt; Script file -&gt; <span class="exturl" data-url="aHR0cDovL2ZpbGVuYW1lLnB5">filename.py</span>)</p><p>The first few blocks of the disassembly seem to be telling us some pretty obvious things, it takes input, copies it to a kernel land string, then stores it.</p><p>How does it reference it though?<br>Let's look at this logically - we know the binary has a print statement somewhere, and it prints 1 of 2 things</p><p><img data-src="/images/post_images/Writeup-beehive-bi0sCTF-2024/image-5.png" alt="correct incorrect print"></p><p>How is it referencing the correct and incorrect strings?</p><p>We can see some constants being loaded into <code>r1</code> in each block, and that constant just happens to be the offset of the strings &quot;Key is correct!&quot; and &quot;Key is incorrect!&quot;, from the .rodata section. <code>r2</code> just holds the length of the string to be printed.</p><p>I don't want to get into too much detail about assembly level reversing here, so I will mention the required details, while trying to retain as much information as possible<br></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">r1 --&gt; loop counter for byte by byte encryption</span><br><span class="line">r2 --&gt; contains the pointer to current encrypted byte </span><br><span class="line">r3 --&gt; is_correct flag </span><br></pre></td></tr></table></figure><p></p><p>And, a python (almost line-by-line) representation of the encryption is as follows:<br></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">r5</span>):</span><br><span class="line">    r7 = r5</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[*] Initial state of r5: <span class="subst">&#123;<span class="string">&#x27;&#123;:08b&#125;&#x27;</span>.<span class="built_in">format</span>(r5)&#125;</span>&quot;</span>)</span><br><span class="line">    r7 &amp;= <span class="number">15</span></span><br><span class="line">    r7 &lt;&lt;= <span class="number">4</span></span><br><span class="line">    r5 &amp;= <span class="number">240</span></span><br><span class="line">    r5 &gt;&gt;= <span class="number">4</span></span><br><span class="line">    r5 |= r7</span><br><span class="line">    r7 = r5</span><br><span class="line">    r7 &amp;= <span class="number">51</span></span><br><span class="line">    r7 &lt;&lt;= <span class="number">2</span></span><br><span class="line">    r5 &gt;&gt;= <span class="number">2</span></span><br><span class="line">    r5 &amp;= <span class="number">51</span></span><br><span class="line">    r5 |= r7</span><br><span class="line">    r7 = r5</span><br><span class="line">    r7 &amp;= <span class="number">85</span></span><br><span class="line">    r7 &lt;&lt;= <span class="number">1</span></span><br><span class="line">    r5 &gt;&gt;= <span class="number">1</span></span><br><span class="line">    r5 &amp;= <span class="number">85</span></span><br><span class="line">    r5 |= r7</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;\n\n[*] Final state of r5: <span class="subst">&#123;<span class="string">&#x27;&#123;:08b&#125;&#x27;</span>.<span class="built_in">format</span>(r5)&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p></p><h2 id="interacting-with-the-program"><a class="anchor" href="#interacting-with-the-program">#</a> Interacting with the program?</h2><p>This is all very nice, but what's a program that you cannot interact with?</p><p>Well, since this is an eBPF program, it'll have to be loaded on the kernel and get past the verifier first, before we can actually make the syscall <code>0x31337</code> to trigger it.</p><p>How do we do that?</p><p>You can use this loader file to load the program and simultaneously read <code>trace_pipe</code> (where the outputs of <code>bpf_trace_printk</code> ) are logged.</p><p>(Run this shell script first)</p><p></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo clang -O2 -target bpf -D__TARGET_ARCH_x86_64 -I . -c <span class="string">&quot;<span class="variable">$1</span>&quot;</span>_challenge.c -o <span class="variable">$1</span>.o</span><br><span class="line">sudo bpftool gen skeleton <span class="variable">$1</span>.o &gt; <span class="variable">$1</span>.skel.h</span><br><span class="line">sudo clang -g -O2 -Wall -I . -c loader.c -o loader.o</span><br><span class="line">sudo clang -Wall -O2 -g loader.o libbpf/build/libbpf/libbpf.a -lelf -lz -o loader</span><br><span class="line">sudo ./loader</span><br></pre></td></tr></table></figure><p></p><p>(Then, run this file to load the program)<br></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/stat.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/resource.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bpf/libbpf.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bpf/bpf.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;final.skel.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">read_trace_pipe</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">int</span> trace_fd;</span><br><span class="line"></span><br><span class="line">	trace_fd = open(<span class="string">&quot;/sys/kernel/debug/tracing/trace_pipe&quot;</span>, O_RDONLY, <span class="number">0</span>);</span><br><span class="line">	<span class="keyword">if</span> (trace_fd &lt; <span class="number">0</span>)</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">		<span class="type">static</span> <span class="type">char</span> buf[<span class="number">4096</span>];</span><br><span class="line">		<span class="type">ssize_t</span> sz;</span><br><span class="line"></span><br><span class="line">		sz = read(trace_fd, buf, <span class="keyword">sizeof</span>(buf) - <span class="number">1</span>);</span><br><span class="line">		<span class="keyword">if</span> (sz &gt; <span class="number">0</span>) &#123;</span><br><span class="line">			buf[sz] = <span class="number">0</span>;</span><br><span class="line">			<span class="built_in">puts</span>(buf);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="keyword">final</span> *<span class="title">obj</span>;</span></span><br><span class="line">	<span class="type">int</span> err = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">rlimit</span> <span class="title">rlim</span> =</span> &#123;</span><br><span class="line">		.rlim_cur = <span class="number">512UL</span> &lt;&lt; <span class="number">20</span>,</span><br><span class="line">		.rlim_max = <span class="number">512UL</span> &lt;&lt; <span class="number">20</span>,</span><br><span class="line">	&#125;;</span><br><span class="line"></span><br><span class="line">	err = setrlimit(RLIMIT_MEMLOCK, &amp;rlim);</span><br><span class="line">	<span class="keyword">if</span> (err) &#123;</span><br><span class="line">		<span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;failed to change rlimit\n&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	obj = final__open();</span><br><span class="line">	<span class="keyword">if</span> (!obj) &#123;</span><br><span class="line">		<span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;failed to open and/or load BPF object\n&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	err = final__load(obj);</span><br><span class="line">	<span class="keyword">if</span> (err) &#123;</span><br><span class="line">		<span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;failed to load BPF object %d\n&quot;</span>, err);</span><br><span class="line">		<span class="keyword">goto</span> cleanup;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	err = final__attach(obj);</span><br><span class="line">	<span class="keyword">if</span> (err) &#123;</span><br><span class="line">		<span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;failed to attach BPF programs\n&quot;</span>);</span><br><span class="line">		<span class="keyword">goto</span> cleanup;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	read_trace_pipe();</span><br><span class="line"></span><br><span class="line">cleanup:</span><br><span class="line">	final__destroy(obj);</span><br><span class="line">	<span class="keyword">return</span> err != <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>Once loaded, you can write a python program to trigger the syscall with the arguments that you want to test it out (I used the <code>ctypes</code> module for this)</p><p>&lt;br&gt;</p><h2 id="the-solution"><a class="anchor" href="#the-solution">#</a> The Solution</h2><p>Once you understand how the program manipulates your input, reversing it becomes quite trivial. The program simply takes each byte of your input, flips the bits (8 padded), then compares it with a preexisting array.</p><p></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">compArray = [<span class="number">86</span>, <span class="number">174</span>, <span class="number">206</span>, <span class="number">236</span>, <span class="number">250</span>, <span class="number">44</span>, <span class="number">118</span>, <span class="number">246</span>, <span class="number">46</span>, <span class="number">22</span>, <span class="number">204</span>, <span class="number">78</span>, <span class="number">250</span>, <span class="number">174</span>, <span class="number">206</span>, <span class="number">204</span>, <span class="number">78</span>, <span class="number">118</span>, <span class="number">44</span>, <span class="number">182</span>, <span class="number">166</span>, <span class="number">2</span>, <span class="number">70</span>, <span class="number">150</span>, <span class="number">12</span>, <span class="number">206</span>, <span class="number">116</span>, <span class="number">150</span>, <span class="number">118</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> compArray: </span><br><span class="line">    i = <span class="string">&#x27;&#123;:08b&#125;&#x27;</span>.<span class="built_in">format</span>(i) </span><br><span class="line">    i = i[::-<span class="number">1</span>]</span><br><span class="line">    i = <span class="built_in">int</span>(i, <span class="number">2</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(i), end = <span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure><p></p><p>And that was my challenge! I hope you had fun solving it and (hopefully) also learned something new while doing it. 😃</p><div class="tags"><a href="/tags/Security/" rel="tag"><i class="ic i-tag"></i> Security</a> <a href="/tags/Reversing/" rel="tag"><i class="ic i-tag"></i> Reversing</a> <a href="/tags/CTF/" rel="tag"><i class="ic i-tag"></i> CTF</a> <a href="/tags/eBPF/" rel="tag"><i class="ic i-tag"></i> eBPF</a> <a href="/tags/Writeup/" rel="tag"><i class="ic i-tag"></i> Writeup</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">Edited on</span> <time title="Modified: 26-08-2024 14:38:22" itemprop="dateModified" datetime="2024-08-26T14:38:22Z">26-08-2024</time></span></div><div id="copyright"><ul><li class="author"><strong>Post author: </strong>Suraj Kumar <i class="ic i-at"><em>@</em></i>The Workshop</li><li class="link"><strong>Post link: </strong><a href="https://the-m3chanic.github.io/2024/02/26/Writeup-beehive-bi0sCTF-2024/" title="Writeup - beehive - bi0sCTF 2024">https://the-m3chanic.github.io/2024/02/26/Writeup-beehive-bi0sCTF-2024/</a></li><li class="license"><strong>Copyright Notice: </strong>All articles in this blog are licensed under <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> unless stating additionally.</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/2024/01/26/Writeup-Secure-Computing-IRIS-CTF-2024/" itemprop="url" rel="prev" data-background-image="&#x2F;images&#x2F;post_covers&#x2F;Writeup-Secure-Computing-IRIS-CTF.jpg" title="Secure Computing - Iris CTF 2024 Writeup"><span class="type">Previous Post</span> <span class="category"><i class="ic i-flag"></i> Writeup</span><h3>Secure Computing - Iris CTF 2024 Writeup</h3></a></div><div class="item right"><a href="/2024/02/26/Writeup-t0y-b0x-bi0sCTF-2024/" itemprop="url" rel="next" data-background-image="&#x2F;images&#x2F;post_covers&#x2F;Writeup-t0y-b0x-bi0sCTF-2024.jpg" title="Writeup - t0y-b0x - bi0sCTF 2024"><span class="type">Next Post</span> <span class="category"><i class="ic i-flag"></i> Writeup</span><h3>Writeup - t0y-b0x - bi0sCTF 2024</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="Contents"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#challenge-description"><span class="toc-number">1.</span> <span class="toc-text">Challenge description:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#initial-analysis"><span class="toc-number">2.</span> <span class="toc-text">Initial Analysis</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#understanding-ebpf"><span class="toc-number">3.</span> <span class="toc-text">Understanding eBPF</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#our-approach"><span class="toc-number">4.</span> <span class="toc-text">Our Approach</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#understanding-the-challenge"><span class="toc-number">5.</span> <span class="toc-text">Understanding the challenge</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#interacting-with-the-program"><span class="toc-number">6.</span> <span class="toc-text">Interacting with the program?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#the-solution"><span class="toc-number">7.</span> <span class="toc-text">The Solution</span></a></li></ol></div><div class="related panel pjax" data-title="Related"><ul><li><a href="/2024/01/26/Writeup-Secure-Computing-IRIS-CTF-2024/" rel="bookmark" title="Secure Computing - Iris CTF 2024 Writeup">Secure Computing - Iris CTF 2024 Writeup</a></li><li class="active"><a href="/2024/02/26/Writeup-beehive-bi0sCTF-2024/" rel="bookmark" title="Writeup - beehive - bi0sCTF 2024">Writeup - beehive - bi0sCTF 2024</a></li><li><a href="/2024/02/26/Writeup-t0y-b0x-bi0sCTF-2024/" rel="bookmark" title="Writeup - t0y-b0x - bi0sCTF 2024">Writeup - t0y-b0x - bi0sCTF 2024</a></li><li><a href="/2024/07/07/Writeup-lost-canary-UIUCTF24/" rel="bookmark" title="Writeup - lost canary - UIUCTF24">Writeup - lost canary - UIUCTF24</a></li><li><a href="/2025/05/12/Defeating-an-LLVM-based-obfuscator/" rel="bookmark" title="Defeating an LLVM based obfuscator with IDA Pro">Defeating an LLVM based obfuscator with IDA Pro</a></li></ul></div><div class="overview panel" data-title="Overview"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="Suraj Kumar" data-src="/images/avatar.jpg"><p class="name" itemprop="name">Suraj Kumar</p><div class="description" itemprop="description"></div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">8</span> <span class="name">posts</span></a></div><div class="item categories"><a href="/categories/"><span class="count">3</span> <span class="name">categories</span></a></div><div class="item tags"><a href="/tags/"><span class="count">19</span> <span class="name">tags</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL3RoZS1tM2NoYW5pYw==" title="https:&#x2F;&#x2F;github.com&#x2F;the-m3chanic"><i class="ic i-github"></i></span> <span class="exturl item twitter" data-url="aHR0cHM6Ly90d2l0dGVyLmNvbS90aGVfbTNjaGFuaWNf" title="https:&#x2F;&#x2F;twitter.com&#x2F;the_m3chanic_"><i class="ic i-twitter"></i></span> <span class="exturl item linkedin" data-url="aHR0cHM6Ly93d3cubGlua2VkaW4uY29tL2luL3RoZS1tM2NoYW5pYw==" title="https:&#x2F;&#x2F;www.linkedin.com&#x2F;in&#x2F;the-m3chanic"><i class="ic i-linkedin"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>Home</a></li><li class="item"><a href="/about/" rel="section"><i class="ic i-user"></i>About</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/2024/01/26/Writeup-Secure-Computing-IRIS-CTF-2024/" rel="prev" title="Previous Post"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/2024/02/26/Writeup-t0y-b0x-bi0sCTF-2024/" rel="next" title="Next Post"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>Random Posts</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/Writeup/" title="In Writeup">Writeup</a></div><span><a href="/2024/07/07/Writeup-lost-canary-UIUCTF24/" title="Writeup - lost canary - UIUCTF24">Writeup - lost canary - UIUCTF24</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Writeup/" title="In Writeup">Writeup</a></div><span><a href="/2024/02/26/Writeup-t0y-b0x-bi0sCTF-2024/" title="Writeup - t0y-b0x - bi0sCTF 2024">Writeup - t0y-b0x - bi0sCTF 2024</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Writeup/" title="In Writeup">Writeup</a></div><span><a href="/2025/05/12/Defeating-an-LLVM-based-obfuscator/" title="Defeating an LLVM based obfuscator with IDA Pro">Defeating an LLVM based obfuscator with IDA Pro</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Writeup/" title="In Writeup">Writeup</a></div><span><a href="/2024/01/26/Writeup-Secure-Computing-IRIS-CTF-2024/" title="Secure Computing - Iris CTF 2024 Writeup">Secure Computing - Iris CTF 2024 Writeup</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/GSoC/" title="In GSoC">GSoC</a></div><span><a href="/2024/08/25/GSoC-Final-Report/" title="GSoC - Final Report">GSoC - Final Report</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Technical/" title="In Technical">Technical</a></div><span><a href="/2024/05/08/R2R-Ready-to-Run-Stomping-WTF/" title="R2R (Ready to Run) Stomping - WTF?">R2R (Ready to Run) Stomping - WTF?</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/GSoC/" title="In GSoC">GSoC</a></div><span><a href="/2024/06/06/GSoC-with-RTEMS-1/" title="GSoC with RTEMS! - 1&#x2F;n">GSoC with RTEMS! - 1/n</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Writeup/" title="In Writeup">Writeup</a></div><span><a href="/2024/02/26/Writeup-beehive-bi0sCTF-2024/" title="Writeup - beehive - bi0sCTF 2024">Writeup - beehive - bi0sCTF 2024</a></span></li></ul></div><div><h2>Recent Comments</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2023 – <span itemprop="copyrightYear">2025</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">Suraj Kumar @ the.m3chanic</span></div><div class="powered-by">Powered by <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"2024/02/26/Writeup-beehive-bi0sCTF-2024/",favicon:{show:"（●´3｀●）:)",hide:"(´Д｀) :("},search:{placeholder:"Search for Posts",empty:"We didn't find any results for the search: ${query}",stats:"${hits} results found in ${time} ms"},valine:!0,fancybox:!0,copyright:'Copied to clipboard successfully! <br> All articles in this blog are licensed under <i class="ic i-creative-commons"></i>BY-NC-SA.',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html><!-- rebuild by hrmmi -->